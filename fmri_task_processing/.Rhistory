knitr::opts_chunk$set(echo = FALSE, prompt = FALSE, message = FALSE, warning = FALSE, comment = "", results = 'hide')
library(pander)
library(rvest)
library(httr)
library(neurobase)
library(matlabr)
library(spm12r)
library(tidyr)
library(ggplot2)
t1_fname = "anat.nii.gz"
knitr::include_graphics("average.png")
times = slice_order/1000
slice_order = c(
1740, 1680, 1620, 1560, 1500, 1440, 1380,
1320, 1260, 1200, 1140, 1080, 1020, 960,
900, 840, 780, 720, 660, 600, 540, 480,
420, 360, 300, 240, 180, 120, 60, 0,
1740, 1680, 1620, 1560, 1500, 1440, 1380,
1320, 1260, 1200, 1140, 1080, 1020, 960,
900, 840, 780, 720, 660, 600, 540, 480, 420,
360, 300, 240, 180, 120, 60, 0)
ref_slice = 900
ta = 0 # since slice_order in ms
times
times = slice_order/1000
times
plot(times)
times = slice_order/1000
slice = rank(times)
rm(slice)
times = slice_order/1000
slices = rank(times)
plot(times, slices)
times
rank(times)
cbind(times, slices)
plot(x = times, y = slices, pch = 9)
plot(x = times, y = slices, pch = 19)
order(times)
times = slice_order/1000
slices = order(times)
plot(x = times, y = slices, pch = 19)
times
plot(x = times, y = slices * 2, pch = 19)
plot(x = times[1:5], y = slices[1:5], pch = 19)
times
times = slice_order/1000
df = arrange(df, time)
df = dplyr::arrange(df, time)
times = slice_order/1000
df = data.frame(time = time, slice = seq(times))
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
df
plot(x = df$time, y = df$slice, pch = 19)
plot(x = df$time, y = df$slice, pch = 19, type = "n")
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25, y1 = y0,
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
plot(x = df$time, y = df$slice, pch = 19, type = "n")
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
# reading in the mean image
mean_img = "meanfmri.nii.gz"
mean_nifti = readnii(mean_img)
?slice()
?slice
slice(mean_nifti, plane = "sagittal")
dim(mean_nifti)
slice(mean_nifti, z = 48, plane = "sagittal")
abline(v = 30, col = "red")
?abline(v = 30, col = "red")
ortho2
?abline(h = 30, col = "red")
abline(h = 30, col = "red")
abline(h = 300, col = "red")
abline(h = 20, col = "red")
slice
findMethods("slice")
oro.nifti:::image.nifti
abline(h = seq(100), col = "red")
abline(h = 1, col = "red")
abline(h = 2, col = "red")
abline(h = 5, col = "red")
abline(h = 1.1, col = "red")
abline(h = 1.2, col = "red")
dev.off()
abline(h = 20, col = "red")
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = 1.2, col = "red")
abline(h = 1, col = "red")
?abline(h = 1, col = "red")
abline(h = 0, col = "red")
abline(h = 0.5, col = "red")
abline(h = 48/60, col = "red")
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
df
df$slice
?abline
slice
oro.nifti:::image.nifti
aspect = mean_nifti@pixdim[4]/mean_nifti@pixdim[2]
aspect
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
aspect = mean_nifti@pixdim[4]/mean_nifti@pixdim[2]
df$pct = df$slice / 60 * aspect
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct, col = "red", lwd = 2)
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
aspect = mean_nifti@pixdim[4]/mean_nifti@pixdim[2]
df$pct = df$slice / 60 * aspect
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct, col = "red", lwd = 2)
df
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct[1], col = "red", lwd = 2)
abline(h = df$pct[2], col = "red", lwd = 2)
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct[1], col = "red", lwd = 2)
abline(h = df$pct[2], col = "red", lwd = 2)
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct[1], col = "red", lwd = 2)
abline(h = df$pct[2], col = "red", lwd = 2)
slice(mean_nifti, z = 48, plane = "sagittal")
abline(h = df$pct[1], col = "red", lwd = 2)
abline(h = df$pct[5], col = "red", lwd = 2)
head(df)
?sclie
slice
?image
?oro.niftiimage
?oro.nifti::image
?oro.nifti::image.nifti
image
mean_nifti
mn2 = nifti(mn2)
mn2 = nifti(mean_nifti)
mn2
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
abline(h = df$pct[1], col = "red", lwd = 2)
abline(h = df$pct[2], col = "red", lwd = 2)
df
max(df$pct)
mn2
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
abline(h = df$pct, col = "red", lwd = 2)
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
for (i in seq(nrow(df))) {
abline(h = df$pct[1], col = "red", lwd = 2)
}
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
for (i in seq(nrow(df))) {
abline(h = df$pct[i], col = "red", lwd = 2)
}
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
for (i in seq(nrow(df))) {
abline(h = df$pct[i], col = "red")
}
oro.nifti:::image.nifti
abline(h= 90)
times = slice_order/1000
df = data.frame(time = times, slice = seq(times))
df = dplyr::arrange(df, time)
plot(x = df$time, y = df$slice, pch = 19, type = "n", xlim = c(0, 1.8))
segments(x0 = df$time, y0 = df$slice, x1 = df$time + 0.25)
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
for (i in seq(nrow(df))) {
abline(h = df$pct[i], col = "red")
}
abline(h= 90, col ="green")
segments(0.5,0.1,0.2,0.25, col = "blue")
mn2 = nifti(mean_nifti)
df$pct = df$slice / 60
slice(mn2, z = 48, plane = "sagittal")
for (i in seq(nrow(df))) {
abline(h = df$pct[i], col = "red")
}
abline(h = 90, col ="green")
segments(0.5,0.1,0.2,0.25, col = "blue")
df$pct
?slice
slice(mn2, z = 48, plane = "sagittal", bg = "white")
slice(mn2, z = 48, plane = "sagittal", bg = "white", axes = TRUE)
slice(mn2, z = 48, plane = "sagittal", bg = "white", axes = TRUE,
oma = rep(1, 4), mar = rep(1, 4))
abline(h = 60, col = "red")
slice(mn2, z = 48, plane = "sagittal", bg = "white", axes = TRUE,
oma = rep(1, 4), mar = rep(1, 4))
abline(h = 60, col = "red")
abline(h = 59, col = "red")
abline(h = 59/60, col = "red")
abline(h = 59/60)
abline(h = 40)
abline(h = 0.5, col = "red")
abline(h = 0.25, col = "red")
abline(h = 0.15, col = "red")
abline(h = 0.01, col = "red")
abline(h = 0.1, col = "red")
abline(h = 0.1, col = "red", lwd = 2)
abline(h = 0.1, col = "red", lwd = 5)
abline(h = 0.0004, col = "red", lwd = 5)
abline(h = -0.1, col = "red", lwd = 5)
mn2 = nifti(mean_nifti)
mn2@.Data <- aperm(x, c(2, 3, 1))
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
x
dim9x
dim(x)
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks)
X <- nrow(x)
Y <- ncol(x)
X <- nrow(x)
Y <- ncol(x)
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks)
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
par(mfrow = c(1,1), oma = rep(0, 4), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
par(mfrow = c(1,1), oma = rep(0, 4), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
par(mfrow = c(1,1), oma = rep(1, 4), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
par(old.packages())
par(oldpar)
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
oldpar <- par(no.readonly = TRUE)
par(mfrow = c(1,1), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
knitr::opts_chunk$set(echo = FALSE, prompt = FALSE, message = FALSE, warning = FALSE, comment = "", results = 'hide')
library(pander)
library(rvest)
library(httr)
library(neurobase)
library(matlabr)
library(spm12r)
library(tidyr)
library(ggplot2)
t1_fname = "anat.nii.gz"
mean_img = "meanfmri.nii.gz"
mean_nifti = readnii(mean_img)
rpfile = "rp_fmri.txt"
rp = read.table(file = rpfile, header = FALSE)
print("rfmri.nii")
print("fmri.mat")
mean_niftix = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
oldpar <- par(no.readonly = TRUE)
par(mfrow = c(1,1), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
x = nifti(mean_nifti)
x = cal_img(x)
x@.Data <- aperm(x, c(2, 3, 1))
col = gray(0:64/64)
zlim <- c(x@cal_min, x@cal_max)
breaks <- c(zlim[1],
seq(min(zlim, na.rm = TRUE),
max(zlim,
na.rm = TRUE),
length = length(col) - 1), zlim[2])
dims = dim(x)
X <- nrow(x)
Y <- ncol(x)
z = 48
oldpar <- par(no.readonly = TRUE)
par(mfrow = c(1,1), mar = rep(0, 4),
bg = "black")
graphics::image(1:X, 1:Y, x[, , z], col = col,
breaks = breaks, bg = "black")
abline(h = 60, col = "red")
oldpar$oma
